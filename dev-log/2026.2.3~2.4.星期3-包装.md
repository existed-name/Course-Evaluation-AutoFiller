## 2026.2.3~2.4.星期3-包装
1. 找Gemini学习怎么打包
    * 先去IDEA里面用Maven把项目连同配置打成`FatJar`——点击`package`即可
    * 然后要分析Jar包依赖模块
    * 剪裁JRE
    * 拼接Jar、JRE打成JPackage
    * 命令行代码
```bash
jdeps ^
--ignore-missing-deps ^
--print-module-deps ^
./jpackage_input/Course-Evaluation-AutoFillerV0.1-0.1-SNAPSHOT.jar

jlink ^
--add-modules java.base,java.compiler,java.desktop,java.instrument,java.logging,java.net.http,jdk.unsupported ^
--output ./v0.1-jre ^
--strip-debug ^
--compress zip-9 ^
--no-header-files ^
--no-man-pages

jpackage ^
  :: 生成.exe安装程序
  :: --type exe ^
  :: 生成无需安装的程序文件夹(此时不能有win-shortcut、win-menu)
  --type app-image ^
  --name "软件名" ^
  --app-version 版本号 ^
  :: 设置文件的图标（png、jpeg需要转成特定文件，如ico）
  --icon 图标的路径 ^
  :: 注意input会把指定文件夹的所有东西装进去，需要提前清理，只保留Jar包
  --input 存放Jar包的（相对）路径 ^
  --main-jar 入口jar包的名字 ^
  --main-class com.公司名.项目名.主类的名称 ^
  --runtime-image 打包用到的Java运行环境（JRE）的（相对）路径 ^
  :: 创建快捷方式
  --win-shortcut ^
  :: 在 Windows 的“开始菜单”里创建一个程序组。如果不加它，用户装完软件只能在桌面找快捷方式
  --win-menu ^
  :: jpackage 默认 GUI 程序，必须指定为控制台程序
  --win-console ^
  :: 强制 JVM 内部所有 IO 流使用 UTF-8，防止读写文件或处理字符串时出现乱码
  --java-options "-Dfile.encoding=UTF-8" ^
  :: 专门针对标准输出（控制台打印）
  --java-options "-Dsun.stdout.encoding=UTF-8" ^
  :: 专门针对报错输出
  --java-options "-Dsun.stderr.encoding=UTF-8" ^
  --dest 输出的目标路径
```

2. cmd/Termail里面运行Jar包，emoji乱码，PowerShell甚至全乱码
    * 输入`chcp 65001`可以把命令行切换到UTF-8，于是往代码里面补了这条命令
    * 但还是有乱码，于是打包时指定编码
    * 不过之后发现，只有那条命令之后的东西才可以UTF-8，而脚本在编译的时候就用的cmd本身的编码，于是再改
```java
if (System.getProperty("os.name").toLowerCase().contains("windows")) {
        try {
            // 1. 尝试改变控制台代码页为 UTF-8
            new ProcessBuilder("cmd", "/c", "chcp 65001 > nul").inheritIO().start().waitFor();
            
            // 2. 关键：强制重置 Java 的标准输出/错误流为 UTF-8
            // 这样即便 JVM 启动时抓取的是 GBK，我们也会在运行中把它改掉
            System.setOut(new PrintStream(System.out, true, StandardCharsets.UTF_8));
            System.setErr(new PrintStream(System.err, true, StandardCharsets.UTF_8));
            
        } catch (Exception ignored) {}
}
```

3. 然后AI又指点我把cmd命令弄进`.txt`，再改成`.bat`批处理文件，改参数、一键打包。u1s1，打成`.exe`安装器，安装的时候挺好玩的

å›åˆ°è´Ÿè´£ç”Ÿæˆæç¤ºè¯çš„é‚£ä¸ªå¯¹è¯

---

å¥½çš„ï¼Œæˆ‘ä»¬ç»§ç»­ï¼Œæç¤ºè¯ä¾ç„¶éœ€è¦æ•™ç¨‹ + ä»£ç ğŸ‘€

1ã€æ¨¡å—äºŒå†…å®¹ğŸ“•
```java
æ¨¡å— 2ï¼šé¡µé¢å¯¼èˆªä¸ç§‘ç›®åˆ—è¡¨æå–
æˆ‘çš„ä»»åŠ¡ï¼š

æä¾›ä¿¡æ¯ï¼šåœ¨æµè§ˆå™¨ä¸­ä½¿ç”¨ F12 å¼€å‘è€…å·¥å…·ï¼Œè§‚å¯Ÿâ€œæ•™å­¦è´¨é‡è¯„ä»·â€èœå•çš„é“¾æ¥æˆ–æŒ‰é’®çš„ HTML ç‰¹å¾ï¼ˆIDã€Class æˆ– Textï¼‰ã€‚
ç¼–å†™è·³è½¬é€»è¾‘ï¼šè®©è„šæœ¬ç‚¹å‡»è¿›å…¥è¯„ä»·åˆ—è¡¨é¡µã€‚
è¯†åˆ«åˆ—è¡¨ï¼šåˆ†æè¯„ä»·è¡¨æ ¼çš„ç»“æ„ï¼Œè·å–æ‰€æœ‰â€œè¿›å…¥è¯„ä»·â€æŒ‰é’®çš„é›†åˆï¼ˆListï¼‰ã€‚
æµ‹è¯•è¾“å‡ºï¼šæ§åˆ¶å°æ‰“å°å‡ºå½“å‰é¡µé¢æœ‰å¤šå°‘ä¸ªç§‘ç›®å¾…è¯„ä»·ï¼ˆä¾‹å¦‚ï¼šâ€œæ£€æµ‹åˆ° 5 é—¨ç§‘ç›®å¾…è¯„ä»·â€ï¼‰ã€‚
```


2ã€æ¨¡å—ä¸€çš„æ€»ç»“ğŸ“ƒ
```java
1. é¡¹ç›®ä¸Šä¸‹æ–‡
å½“å‰çŠ¶æ€ï¼šæ¨¡å—ä¸€å·²å®Œæˆï¼Œæµè§ˆå™¨å·²å¯åŠ¨å¹¶å¤„äºå·²ç™»å½•çŠ¶æ€ï¼ˆå¤ç”¨äº† Edge User Dataï¼‰ã€‚
å½“å‰é¡µé¢ï¼šæ•™åŠ¡ç³»ç»Ÿé¦–é¡µ
æŠ€æœ¯æ ˆï¼šJava 21 + Selenium 4.40.0 + EdgeDriver 144.0ã€‚
æ ¸å¿ƒç‰¹å¾ï¼šä½¿ç”¨ user-data-dir å¤ç”¨ç™»å½•æ€ï¼Œè„šæœ¬å¯åŠ¨åæ— éœ€å†æ¬¡ç™»å½•ã€‚

2. æ¨¡å—äºŒèŒè´£ï¼ˆå¿…é¡»å®ç°ï¼‰
å¯¼èˆªï¼šä»å½“å‰æ•™åŠ¡é¦–é¡µç‚¹å‡»"æ•™å­¦è´¨é‡è¯„ä»·"èœå•ï¼Œè¿›å…¥è¯„ä»·åˆ—è¡¨é¡µ
è§£æï¼šæå–è¯„ä»·åˆ—è¡¨è¡¨æ ¼ï¼Œè¯†åˆ«æ‰€æœ‰å¾…è¯„ä»·ç§‘ç›®
å°è£…ï¼šå°†æ¯ä¸ªç§‘ç›®å°è£…ä¸ºæ•°æ®å¯¹è±¡ï¼ˆå«ï¼šè¯¾ç¨‹åã€æ•™å¸ˆã€è¯„ä»·é“¾æ¥/æŒ‰é’®ï¼‰
æ ¡éªŒï¼šæ§åˆ¶å°è¾“å‡º "æ£€æµ‹åˆ° X é—¨ç§‘ç›®å¾…è¯„ä»·"
é¢„å¤‡ï¼šä¸ºæ¨¡å—ä¸‰æä¾›è¿›å…¥å•ä¸ªè¯„ä»·é¡µçš„èƒ½åŠ›ï¼ˆæ–¹æ³•æˆ–å›è°ƒï¼‰

3. å¯ç”¨èµ„æºï¼ˆä»æ¨¡å—ä¸€è·å–ï¼‰
// è·å–å·²åˆå§‹åŒ–çš„ WebDriver å®ä¾‹ï¼ˆå·²ç™»å½•ï¼Œåœ¨é¦–é¡µï¼‰EvaluationAutomator automator = new EvaluationAutomator();
automator.initEnvironment();  // è¿™ä¼šå¯åŠ¨æµè§ˆå™¨å¹¶å¤ç”¨ç™»å½•æ€WebDriver driver = automator.getDriver();  // å…³é”®ï¼šæ¨¡å—äºŒé€šè¿‡æ­¤æ–¹æ³•æ“ä½œæµè§ˆå™¨// å½“å‰é¡µé¢ç‰¹å¾ï¼ˆä¾› XPath/CSS å‚è€ƒï¼‰String CURRENT_URL = "https://matrix.dean.swust.edu.cn/acadmicManager/index.cfm?event=studentPortal:DEFAULT_EVENT";// ç™»å½•æ€æ ‡è¯†ï¼ˆå·²å­˜åœ¨äºé¡µé¢ï¼‰ï¼š//*[@id="navAccountLink"] æˆ–åŒ…å«"è¯„ä»·"çš„é“¾æ¥
å…³é”®çº¦æŸï¼šæ¨¡å—ä¸€å·²é…ç½® IMPLICIT_WAIT_TIMEOUT = 5s å’Œ EXPLICIT_WAIT_TIMEOUT = 10sï¼Œæ¨¡å—äºŒå¿…é¡»ä½¿ç”¨æ˜¾å¼ç­‰å¾…å¤„ç†é¡µé¢è·³è½¬

3. æŠ€æœ¯è§„èŒƒï¼ˆå¼ºåˆ¶éµå®ˆï¼‰
3.1 ä»£ç ç»“æ„
åŒ…åï¼šcom.github.existed_name.teachingevaluationauto
ç±»åï¼šå»ºè®®æ–°å»º EvaluationNavigatorï¼ˆå¤„ç†å¯¼èˆªï¼‰å’Œ SubjectExtractorï¼ˆå¤„ç†è§£æï¼‰
å¸¸é‡ç®¡ç†ï¼šæ‰€æœ‰ XPathã€URLã€CSS Selector å¿…é¡»æå–ä¸º private static final å¸¸é‡ï¼Œç¦æ­¢ç¡¬ç¼–ç åœ¨æ–¹æ³•ä¸­

3.2 ç­‰å¾…æœºåˆ¶ï¼ˆé‡ç‚¹ï¼‰
// é¡µé¢è·³è½¬åå¿…é¡»ä½¿ç”¨æ˜¾å¼ç­‰å¾…ï¼Œç¦æ­¢ Thread.sleep()WebDriverWait wait = new WebDriverWait(driver, Duration.ofSeconds(10));// ç¤ºä¾‹ï¼šç­‰å¾…è¯„ä»·åˆ—è¡¨è¡¨æ ¼åŠ è½½
wait.until(ExpectedConditions.presenceOfElementLocated(By.xpath("//table[contains(@class, 'evaluation-list')]")));

3.3 å…ƒç´ å®šä½ç­–ç•¥
ä¼˜å…ˆé¡ºåºï¼šID > Name > XPathï¼ˆcontains æ–‡æœ¬ï¼‰> CSS Selector > ç»å¯¹ XPath
æ•™åŠ¡ç³»ç»Ÿç‰¹å¾ï¼šç³»ç»Ÿä½¿ç”¨ ColdFusionï¼ˆ.cfmï¼‰ï¼ŒID é€šå¸¸æ˜¯åŠ¨æ€ç”Ÿæˆçš„ï¼ˆå¦‚ id="evaluationList_8234"ï¼‰ï¼Œå»ºè®®ä½¿ç”¨ contains(text(),'xxx') æˆ– CSS ç±»åå®šä½ï¼Œé¿å…ä¾èµ–åŠ¨æ€ ID

3.4 å¼‚å¸¸å¤„ç†
æ‰€æœ‰ Selenium æ“ä½œå¿…é¡» try-catchï¼Œæ•è· TimeoutException å’Œ NoSuchElementException
å¤±è´¥æ—¶æ‰“å°å½“å‰ URL å’Œé¡µé¢æ ‡é¢˜ï¼Œæ–¹ä¾¿è°ƒè¯•

4. æ•°æ®æ¨¡å‹å®šä¹‰ï¼ˆå»ºè®®ï¼‰
public class EvaluationSubject {
    private String courseName;      // è¯¾ç¨‹åç§°
    private String teacherName;     // æ•™å¸ˆå§“å
    private String semester;        // å­¦æœŸï¼ˆå¯é€‰ï¼‰
    private WebElement enterButton; // "è¿›å…¥è¯„ä»·"æŒ‰é’®å…ƒç´ ï¼ˆä¾›ç‚¹å‡»ç”¨ï¼‰
    private String status;          // çŠ¶æ€ï¼š"å¾…è¯„ä»·"/"å·²å®Œæˆ"ï¼ˆç”¨äºè¿‡æ»¤ï¼‰
    
    // Getter/Setter çœç•¥}// æ¨¡å—äºŒè¾“å‡ºç»™æ¨¡å—ä¸‰çš„ç»“æ„public class EvaluationTask {
    private List<EvaluationSubject> pendingSubjects; // å¾…è¯„ä»·ç§‘ç›®åˆ—è¡¨
    private int totalCount;      // æ€»æ•°
    private int pendingCount;    // å¾…è¯„ä»·æ•°
    
    public void executeAll();    // æ¨¡å—ä¸‰å°†å®ç°ï¼šéå†å¹¶è¯„ä»·}

5. æ¨¡å—è¾¹ç•Œä¸æ¥å£
è¾“å…¥ï¼ˆä»æ¨¡å—ä¸€æ¥æ”¶ï¼‰
WebDriver driverï¼šå·²ç™»å½•ï¼Œåœç•™åœ¨æ•™åŠ¡é¦–é¡µ
æµè§ˆå™¨å·²æœ€å¤§åŒ–ï¼ŒEdgeDriver å·²é…ç½® user-data-dir

è¾“å‡ºï¼ˆä¸ºæ¨¡å—ä¸‰å‡†å¤‡ï¼‰
List<EvaluationSubject> getPendingSubjects()ï¼šè·å–æ‰€æœ‰å¾…è¯„ä»·ç§‘ç›®åˆ—è¡¨
void enterEvaluationPage(EvaluationSubject subject)ï¼šç‚¹å‡»è¿›å…¥æŸä¸ªç§‘ç›®çš„è¯„ä»·é¡µ
éªŒè¯æ ‡å‡†ï¼šèƒ½å‡†ç¡®æ‰“å° "æ£€æµ‹åˆ° X é—¨ç§‘ç›®å¾…è¯„ä»·"ï¼Œä¸” X ä¸è‚‰çœ¼çœ‹åˆ°çš„"è¿›å…¥è¯„ä»·"æŒ‰é’®æ•°é‡ä¸€è‡´
```

---


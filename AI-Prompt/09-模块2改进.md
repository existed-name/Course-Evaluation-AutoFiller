然后Claude就把剩下的都干完了😅

---

现在我们根据之前的对话讨论、信息模板进行优化、给出完整代码

备注:记得给出某些提醒(比如某些细节需要我干什么)

原来的包结构:

```java
com.github.existed_name.teachingevaluationauto
|-model
    |-EvaluationSubject
|-util
    |-EvaluationSubject
    |-SubjectExtractor
|-config
    |-XPathConstants
|-EvaluationAutomator、Phase2Test
```



```
信息模板
【1. 架构选择】
选择 方案B：模块化方案（多类协作）

【2. 表格结构确认】
我的"教学质量评价"列表页面的表格列顺序是：
第1列：行序号（如：1、2、3）
第2列：任课单位（如：计科）
第3列：课程 - 老师名（如：面向对象程序设计 - 老师）
第4列：学分（如：2.50）
第5列：周次（如：02-09）
第6列`网上评价`按钮（点击后等待生成问卷，并在当前页面跳转到该课程`教学质量评价问卷`）

【3. XPath精确路径】
"教学质量评价"菜单的ID/Class：
<复制浏览器F12中的完整XPath>
`//*[@id="navItem_app_evaluateOnline"]/a/div[2]/div`
备用: 
`//a[contains(text(), '教学质量评价')`没有搜到，但是！！！
`$x("//a[contains(., 'xxx')]")$x("//a[contains(normalize-space(.), 'xxx')]")`确实Console成功了
那么我们可以把表达式换`//a[contains(normalize-space(.), '教学质量评价')]`
也就是说，我们的Xpath数组除了精准复制的Xpath，还需要备用这种处理换行、缩进、首尾空格，匹配标签内部文字的Xpath
评价列表表格的ID/Class：
<复制表格元素的XPath>
从大到小、从内到外
1. 最大的那块`教学质量评价`区域块`//*[@id="contentArea"]`
2. 去`headArea教学质量评价`那个标题`//*[@id="contentArea"]/div[2]`
3. `教学质量评价学生问卷`区域`//*[@id="Questionnaire"]`
4. 这里就是纯粹的表格`//*[@id="Questionnaire"]/table`
`网上评价`按钮（超链接）的HTML代码（都是这种结构）：
```
```
<td>
<a class="stat info" title="网上评价" href="index.cfm?event=evaluateOnline:evaluateResponse&amp;ES=01&amp;SCC=5120244475%2C121689%2C251C&amp;ST=D286D9B45B0A330D72F9FFDC3A6709795BEFEDE7CB2625A296789F450F60CECEAC4758B4D72A64F523D9B4305AFBF4D3&amp;TSK=251%2C121689%2CB02&amp;TT=C"></a>
</td>
```

```
【4. URL特征】
点击"教学质量评价"后的URL包含： evaluate
并且界面包含Xpath`//*[@id="headArea"]/div/div/div[2]/h2/text()`的标题“教学质量评价”（也有其他Xpath判断方式）
点击"网上评价"按钮后的URL包含：evaluateResponse
并且界面包含Xpath`//*[@id="labDetail"]教学质量评价问卷`元素`<span class="active" id="labDetail" tabtarget="Detail">教学质量评价问卷</span>`

【5. 评价表单结构（模块三会用）】
问卷题目数量：约9题，都在表格里面，表格Xpath`//*[@id="sheetTable"]`
选项类型：
□ 8个单选
1道题4个选项，分布在表格行里面，比如
```
```
<tr class="cellBorder">
	<td class="quota ltr" rowid="01003">
		<a data-opt="1" href="javascript:postQuota('01003','1','BA49DD474724B5C598E3F3DFE48A460C');">非常满意</a>
		<a data-opt="2" href="javascript:postQuota('01003','2','1CEB6F7EBAAA74881AF360B9A492D2C6');">满意</a>
		<a data-opt="3" href="javascript:postQuota('01003','3','49626A9724EDB9007D2112EA9643CD4C');">基本满意</a>
		<a data-opt="4" href="javascript:postQuota('01003','4','2E757C70339A20BAD74E1FDA8B3109EB');">不满意</a>
	</td>
</tr>
```

```
选项都是这种HTML结构，最明显的就是通`data-opt`来选择，也就是统统选择1即可；并且所有选项都`<td class="quota ltr" rowid="...">`里面
□ 1个文本框（意见和建议）
Xpath`//*[@id="CourseComment"]`，元素代`<textarea class="comment" name="CourseComment" id="CourseComment" verification="required"></textarea>`
只需要填写“无”即可
最后点击Xpath`//*[@id="postTrigger"]`、代码`<input id="postTrigger" disabled="disabled" class="button disabled" type="submit" value="提交评价表">提交评价表`按钮，系统自动返回到"教学质量评价"界面

【6. 其他需求】
不需要处理验证码
不需要处理弹窗确认
不需要截图保存评价记录
```

---

